---
import type { MarkdownInstance } from "astro";

const files = await Astro.glob("../../../pages/docs/items/**/*.md");
for (let i = 0; i < 100; i++) {
    files.push(files[0]);
}

const sections = files.reduce((acc, file) => {
    const category: string = file.url!.split("/")[3];

    if (!acc[category]) acc[category] = [];

    acc[category].push(file);

    return acc;
}, {} as Record<string, MarkdownInstance<Record<string, any>>[]>);

const categories = Object.keys(sections);
---

<aside aria-label="Sidebar">
    <nav class="mr-16 w-full py-4">
        <ul class="overflow-y-auto overflow-x-visible">
            {
                categories.map((category) => (
                    <li>
                        <div class="pt-5">
                            <h1 class="w-full text-2xl font-extrabold text-white ">
                                {category}
                            </h1>
                            <ul>
                                {sections[category].map((section) => (
                                    <li class="my-2 rounded-sm p-2 text-white transition-colors duration-150 hover:bg-white/20">
                                        <a href={section.url} class="px-4">
                                            {section.frontmatter.title}
                                        </a>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    </li>
                ))
            }
        </ul>
    </nav>
</aside>
